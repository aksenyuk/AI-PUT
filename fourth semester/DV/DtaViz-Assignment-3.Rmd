---
output: 
  html_document:
    toc: true
    toc_float: yes
    theme: united
---

```{r, echo=FALSE}
knitr::include_graphics("C:/Users/1625203/Desktop/DV/PP_logotyp_ANG_RGB.png")
```

# **Reproducible report**
#### **Sofya Aksenyuk, 150284; Uladzimir Ivashka, 150281**

```{r, echo=F, include=FALSE}
library(ggpubr)
library(ggplot2)
library(knitr)
library(DT)
library(lubridate)
library(dplyr)
library(ggpubr)
library(tidyr)
library(tidyverse)
library(ggthemes)
library(ggsci)
library(maps)
library(plotly)
library(gridExtra)
library(grid)
library(ggpmisc)
library(ggforce)
library(ggridges)
library(colorspace)
library(rcartocolor)
```
```{r, echo=F}
knitr::opts_chunk$set(warning=FALSE, message = FALSE)
```

```{r, echo=F, include=FALSE}
gold <- read.csv("C:/Users/1625203/Desktop/DV/Data pack/Gold prices.csv")
typeof(gold)
am <- gold[, c(1, 2, 3, 4)]
pm <- gold[, c(7, 8, 9, 10)]
colors <- c('USD' = "mediumpurple1", 'EURO' = 'gold', 'GBP' = 'palevioletred1')

bch <- read.csv("C:/Users/1625203/Desktop/DV/Data pack/Bitcoin/BCHAIN-TRVOU.csv")
bch_data <- bch[c(1:2000), c(1:4)]
bch_data_sep <- bch[c(1:280), c(2:4)]

cur <- read.csv("C:/Users/1625203/Desktop/DV/Data pack/CurrencyExchangeRates.csv")
cor = cur[c(3800:5000), c(1, 15, 51, 52)]
cor[,2] = cor[,3] / cor[,2]

sp <- read.csv("C:/Users/1625203/Desktop/DV/Data pack/S&P Composite.csv")
comp <- sp[, c(1, 2)] 
titles1 <- c(names(sp)[3:6])
titles2 <- c(names(sp)[7:10])
latest1 <- c(unname(sp[1, c(3:6)]))
latest2 <- c(unname(sp[1, c(7:10)]))
latest_data <- data.frame(matrix(ncol = 4, nrow = 4))
latest_data[1,] <- titles1
latest_data[2,] <- latest1
latest_data[3,] <- titles2
latest_data[4,] <- latest2
table <- unname(latest_data)

sp <- read.csv("C:/Users/1625203/Desktop/DV/Data pack/S&P Composite.csv")
sps = sp[c(1:260), c(1,7,8,9,10)]

devl <- read.csv("C:/Users/1625203/Desktop/DV/Data pack/THIS_World_Development_Indicators.csv")
ur = devl[,c(1, 4, 55)]
data = ur %>% filter(Series.Code %in% 'CM.MKT.TRAD.CD')
data = data %>% filter(value != '..')
data = data[c(1,2,3,5,6,7,8),]
data2 = ur %>% filter(Series.Code %in% 'CM.MKT.TRAD.GD.ZS')
data2 = data2 %>% filter(value != '..')
data2 = data2[c(1:7),]
lol <- merge(data, data2, all = TRUE)

```

### **Executive summary**
    
#### The following report examines various aspects of Stock Market, namely:

- Gold
- Bitcoin
- Currency
- S&P Composite
- Traded shares

#### within specific time intervals.

#### Now, let's elaborate on each of the listed points.

### **Gold prices**

#### The examination below presents the comparison between morning and evening gold prices with respect to three different currencies (namely, USD, EUR, GBP) in the time interval from 1968 to 2021.

```{r, fig.width=10, fig.height=8}
one <- ggplot(am, aes(x=as.Date(Date, "%Y-%m-%d"), group = 1)) + 
  geom_line(aes(y=USD, color = 'USD')) + 
  geom_line(aes(y=EURO, color='EURO')) + 
  geom_line(aes(y=GBP, color='GBP')) + 
  labs(y='Units of currency', x='Dates', color='Currencies') +
  theme_minimal() + 
  scale_color_manual(values = colors)

plot1_1 <- annotate_figure(one, top = text_grob("Gold Prices (AM)", face = "bold", size = 14, family = "mono"))

two <- ggplot(pm, aes(x=as.Date(Date.1, "%Y-%m-%d"), group = 1)) + 
  geom_line(aes(y=USD.1, color = 'USD')) + 
  geom_line(aes(y=EURO.1, color='EURO')) + 
  geom_line(aes(y=GBP.1, color='GBP')) + 
  labs(y='Units of currency', x='Dates', color='Currencies') +
  theme_minimal() +
  scale_color_manual(values = colors)

plot1_2 <- annotate_figure(two, top = text_grob("Gold Prices (PM)", face = "bold", size = 14, family = "mono"))

ggarrange(plot1_1, plot1_2, nrow=2, common.legend = TRUE, legend = "right")
```

#### **Observations:** It can be noticed that gold prices increased dramatically within the given time period. However, the difference between morning (AM) and evening (PM) change can be hardly seen.


### **Bitcoin**
#### The plots below show the statistics of Bitcoin Exchange Trade Volume and Bitcoin Market Price with respect to USD from 2016 to 2021.

```{r, fig.width=14, fig.height=7}
pl <- ggplot(bch_data, aes(x = trade, y = factor(Year), fill = ..x..)) +
  geom_density_ridges_gradient(scale = .9, gradient_lwd = .5,
                               color = "black", show.legend = FALSE) +
  scale_fill_viridis_c(option = "plasma", name = "") +
  theme_minimal() +
  theme(text = element_text(size=15)) +
  xlim(0, 175000000) + 
  labs(x='Volume (USD)', y='')
plot_tr <- annotate_figure(pl, top = text_grob("Bitcoin USD Exchange Trade Volume", face = "bold", size = 18, family = "mono"))

pl2 <- ggplot(bch_data, aes(x = market, y = factor(Year), fill = Year)) +
  geom_density_ridges(alpha = .8, color = "black",
                      scale = 2.5, rel_min_height = .01) +
  labs(x = "Market Price (USD)", y = "") +
  guides(fill = FALSE) +
  theme_minimal() +
  theme(text = element_text(size=15)) +
  xlim(-1000, 12500)

plot_market <- annotate_figure(pl2, top = text_grob("Bitcoin Market Price", face = "bold", size = 18, family = "mono"))

ggarrange(plot_tr, plot_market, ncol=2)
```

#### It is necessary to give a separate plot for Market Price in 2021 since its increasing trend led to the enormously higher value range.

```{r, fig.height=5, fig.width=7}
sep_mark <- ggplot(bch_data_sep, aes(y=market)) + 
  geom_boxplot(aes(x=Year), color="purple4", fill="plum2", alpha=0.5, size=1) +
  scale_x_discrete(labels= "2021") +
  theme_minimal() +
  labs(x = "2021", y = "Market Price (USD)") +
  theme(legend.position="none")

annotate_figure(sep_mark, top = text_grob("Market Price (USD) separately for 2021", face = "bold", size = 14, family = "mono"))
```

#### **Observations:** Both - Bitcoin Exchange Trade Volume and Market Price experienced significant grow by the end of 2021.



### **Currency**
#### The given plot analises the correlation value between the most widely used world currencies calculated using Forex correlation trading system.

```{r, fig.width = 10, fig.height = 7}
cor_plot <- ggplot(cor, aes(x=as.Date(Date, "%Y-%m-%d"), group = 1)) + 
  geom_line(aes(y=EUR , color = 'EURO / GPB'), size=1) + 
  geom_line(aes(y=GBP, color='GBP / USD'), size=1) +
  labs(y='Units of currency', x='Year', color='Currencies') +
  theme_minimal()

annotate_figure(cor_plot, top = text_grob("Currency Correlation", face = "bold", size = 14, family = "mono"))
```

#### **Observations:** According to the definition of correlation in forex trading, a positive correlation can be concluded since both lines moves exactly in the same direction throughout the whole period of time.

### **S&P Composite**
#### The following chart shows the S&P Composite Index within 1.5 centuries as well as the latest values of it.

```{r, fig.width=10}
one3 <- ggplot(comp, aes(x=as.Date(Year, "%Y-%m-%d"), y=S.P.Composite, group = 1)) + 
  geom_area(color='Orange', fill='Orange', alpha=0.2) +
  labs(y='S&P Composite', x='Dates') +
  theme_minimal() 

plot3 <- one3  + geom_table_npc(data = table, label = list(table),npcx = 0.075, npcy = 0.95, hjust = 0, vjust = 1) + geom_text( x = -30000,y=4650, label="Latest values", size=4, family = "mono", fontface = "bold")

annotate_figure(plot3, top = text_grob("S&P Composite", face = "bold", size = 14, family = "mono"))
```

#### It is also important to present the statistics of the other values.

```{r, fig.width = 10}
dv = ggplot(sps, aes(x='Real Divident', y=Real.Dividend)) + 
  geom_violin(color="Red", fill = "Red", size = 1, alpha = .2) + 
  geom_jitter(color="Red", fill = "Red", alpha = .25, width = .3) + 
  theme_minimal() + 
  labs(x='',y='')

er = ggplot(sps, aes(x='Real Earnings', y=Real.Earnings)) + 
  geom_violin(color="chartreuse2", fill = "chartreuse2",  size = 1, alpha = .2) + 
  geom_jitter(color="chartreuse2", fill = "chartreuse2", alpha = .25, width = .3) + 
  theme_minimal() + 
  labs(x='', y='')

pr = ggplot(sps, aes(x='Real Price', y=Real.Price)) + 
  geom_violin(color="cornflowerblue", fill = "cornflowerblue",  size = 1, alpha = .2) + 
  geom_jitter(color="cornflowerblue", fill = "cornflowerblue", alpha = .25, width = .3) + 
  theme_minimal() + 
  labs(x='',y='')

ra = ggplot(sps, aes(x='Ratio', y=Cyclically.Adjusted.PE.Ratio)) + 
  geom_violin(color="gold", fill = "gold",  size = 1, alpha = .2)+ 
  geom_jitter(color="gold", fill = "gold", alpha = .25, width = .3) + 
  theme_minimal() + 
  labs(x='',y='')

plot4 <- ggarrange(dv, er, pr, ra, ncol=4)

annotate_figure(plot4, top = text_grob("Distribution for last 20 years", face = "bold", size = 14, family = "mono"))
```

#### **Observations:** Since S&P Composite Index tracks the performance of the largest companies listed on primary stock exchange, it can be colcluded that it has a constant grow starting from around 1950. When it comes to the second plot, it can be found essential to mention the increasing trend of Real Earnings, fluctuating tendency of Ratio, whereas Real Divident and Real Price values seem to go down steadily.



### **Traded shares**
#### The bar chart below depicts comparison between stock traded total value with respect to two units: current US$ and % of GPD, among different countries.

```{r, fig.width = 10}
plot6 <- ggplot(lol, aes(x=region, y=value, fill=Series.Code)) + 
  geom_bar(position='dodge', stat="identity") + 
  geom_text(aes(label = value), position = position_dodge(0.9), hjust=1.1, size =4, fontface = "bold", color="white") + 
  theme_minimal() + 
  theme(text = element_text(size=15), axis.text.x=element_blank(), axis.title = element_blank(), legend.position="bottom", legend.text=element_text(size=12)) + 
  scale_fill_discrete(name = "Series", labels = c("Total value (current USD)", "Total value (% of GDP)")) + 
  coord_flip()

annotate_figure(plot6, top = text_grob("Comparison between current US$ and % of GPD\nof stock traded total value among different countries", face = "bold", size = 15, family = "mono"))
```

#### **Observations:** As it can be seen, Brazil, Bangladesh, Austria and Australia got leading places in Total value (GDP %), while on the contrary Belarus, Barbados and Argentina have significantly lower values. Speaking of Total value (current USD), the best performance goes to Belarus and Barbados; Bangladesh, Austria and Argentina have medium indicators, whereas Australia has the lowest value among listed countries.
